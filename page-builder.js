!function(t){var e={};function o(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=t,o.c=e,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=18)}([function(t,e,o){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var o=function(t,e){var o=t[1]||"",n=t[3];if(!n)return o;if(e&&"function"==typeof btoa){var r=(l=n,a=btoa(unescape(encodeURIComponent(JSON.stringify(l)))),s="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(s," */")),i=n.sources.map((function(t){return"/*# sourceURL=".concat(n.sourceRoot||"").concat(t," */")}));return[o].concat(i).concat([r]).join("\n")}var l,a,s;return[o].join("\n")}(e,t);return e[2]?"@media ".concat(e[2]," {").concat(o,"}"):o})).join("")},e.i=function(t,o,n){"string"==typeof t&&(t=[[null,t,""]]);var r={};if(n)for(var i=0;i<this.length;i++){var l=this[i][0];null!=l&&(r[l]=!0)}for(var a=0;a<t.length;a++){var s=[].concat(t[a]);n&&r[s[0]]||(o&&(s[2]?s[2]="".concat(o," and ").concat(s[2]):s[2]=o),e.push(s))}},e}},function(t,e,o){"use strict";var n,r=function(){return void 0===n&&(n=Boolean(window&&document&&document.all&&!window.atob)),n},i=function(){var t={};return function(e){if(void 0===t[e]){var o=document.querySelector(e);if(window.HTMLIFrameElement&&o instanceof window.HTMLIFrameElement)try{o=o.contentDocument.head}catch(t){o=null}t[e]=o}return t[e]}}(),l=[];function a(t){for(var e=-1,o=0;o<l.length;o++)if(l[o].identifier===t){e=o;break}return e}function s(t,e){for(var o={},n=[],r=0;r<t.length;r++){var i=t[r],s=e.base?i[0]+e.base:i[0],c=o[s]||0,d="".concat(s," ").concat(c);o[s]=c+1;var p=a(d),u={css:i[1],media:i[2],sourceMap:i[3]};-1!==p?(l[p].references++,l[p].updater(u)):l.push({identifier:d,updater:g(u,e),references:1}),n.push(d)}return n}function c(t){var e=document.createElement("style"),n=t.attributes||{};if(void 0===n.nonce){var r=o.nc;r&&(n.nonce=r)}if(Object.keys(n).forEach((function(t){e.setAttribute(t,n[t])})),"function"==typeof t.insert)t.insert(e);else{var l=i(t.insert||"head");if(!l)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");l.appendChild(e)}return e}var d,p=(d=[],function(t,e){return d[t]=e,d.filter(Boolean).join("\n")});function u(t,e,o,n){var r=o?"":n.media?"@media ".concat(n.media," {").concat(n.css,"}"):n.css;if(t.styleSheet)t.styleSheet.cssText=p(e,r);else{var i=document.createTextNode(r),l=t.childNodes;l[e]&&t.removeChild(l[e]),l.length?t.insertBefore(i,l[e]):t.appendChild(i)}}function h(t,e,o){var n=o.css,r=o.media,i=o.sourceMap;if(r?t.setAttribute("media",r):t.removeAttribute("media"),i&&btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}var b=null,f=0;function g(t,e){var o,n,r;if(e.singleton){var i=f++;o=b||(b=c(e)),n=u.bind(null,o,i,!1),r=u.bind(null,o,i,!0)}else o=c(e),n=h.bind(null,o,e),r=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(o)};return n(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;n(t=e)}else r()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=r());var o=s(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var n=0;n<o.length;n++){var r=a(o[n]);l[r].references--}for(var i=s(t,e),c=0;c<o.length;c++){var d=a(o[c]);0===l[d].references&&(l[d].updater(),l.splice(d,1))}o=i}}}},function(t,e,o){var n=o(1),r=o(3);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[t.i,r,""]]);var i={insert:"head",singleton:!1};n(r,i);t.exports=r.locals||{}},function(t,e,o){"use strict";o.r(e);var n=o(0),r=o.n(n)()(!1);r.push([t.i,'html{width:100vw;height:100vh;overflow:hidden}body{width:100%;height:100%;overflow:hidden;display:block;position:relative;font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;background-color:#edf2f7;color:#2d3748}[draggable="true"]{user-select:none;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none}a{text-decoration:none}\n',""]),e.default=r},function(t,e,o){var n=o(1),r=o(5);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[t.i,r,""]]);var i={insert:"head",singleton:!1};n(r,i);t.exports=r.locals||{}},function(t,e,o){"use strict";o.r(e);var n=o(0),r=o.n(n)()(!1);r.push([t.i,'.pt-bttn{display:inline-flex;height:36px;line-height:36px;border-width:1px;border-style:solid;border-color:transparent;font-size:.875rem;text-transform:uppercase;user-select:none;font-weight:500;cursor:pointer;transition:all 75ms ease-in-out;justify-content:center;align-items:center;flex-flow:row nowrap}html[state="soft-loading"] .pt-bttn[type="submit"]{border-color:#eee !important;background-color:#eee !important;cursor:not-allowed !important;color:#616161 !important}html[state="soft-loading"] .pt-bttn[type="submit"]::before{display:none !important}.pt-bttn[disabled]{border-color:#eee !important;background-color:#eee !important;cursor:not-allowed !important;color:#616161 !important}.pt-bttn[disabled]::before{display:none !important}.pt-bttn.-text{padding:0 0.5rem;color:#4a5568}.pt-bttn.-text.-primary:hover,.pt-bttn.-text.-primary:focus{color:#434190}.pt-bttn.-text.-primary:active{color:#3c366b}.pt-bttn.-text.-primary::before{background-color:#667eea}.pt-bttn.-text.-black:active{color:#1a202c}.pt-bttn.-text.-black::before{background-color:#1a202c}.pt-bttn.-text.-grey:active{color:#2d3748}.pt-bttn.-text.-grey::before{background-color:#718096}.pt-bttn.-text.-white{color:#fff}.pt-bttn.-text.-white::before{background-color:#fff}.pt-bttn.-text.-success:hover,.pt-bttn.-text.-success:focus{color:#276749}.pt-bttn.-text.-success:active{color:#276749}.pt-bttn.-text.-success::before{background-color:#48bb78}.pt-bttn.-text.-warning:hover,.pt-bttn.-text.-warning:focus{color:#975a16}.pt-bttn.-text.-warning:active{color:#744210}.pt-bttn.-text.-warning::before{background-color:#ecc94b}.pt-bttn.-text.-danger:hover,.pt-bttn.-text.-danger:focus{color:#c53030}.pt-bttn.-text.-danger:active{color:#9b2c2c}.pt-bttn.-text.-danger::before{background-color:#f56565}.pt-bttn.-text:hover,.pt-bttn.-text:focus{color:#2d3748}.pt-bttn.-text:hover::before,.pt-bttn.-text:focus::before{opacity:0.1;transform:translate(-50%, -50%) scale(1);transition:all 150ms cubic-bezier(0.175, 0.885, 0.32, 1.275)}.pt-bttn.-text:active::before{opacity:0.15;transform:translate(-50%, -50%) scale(1)}.pt-bttn.-text::before{content:"";display:inline-block;width:100%;height:100%;border-radius:0.125rem;background-color:transparent;opacity:0.06;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%) scale(0);transition:all 75ms cubic-bezier(0.4, 0, 0.2, 1)}.pt-bttn.-solid{padding:0 1rem}.pt-bttn.-solid.-primary{background-color:#4c51bf;border-color:#4c51bf;color:#fff}.pt-bttn.-solid.-primary:hover,.pt-bttn.-solid.-primary:focus{background-color:#5a67d8;border-color:#5a67d8;color:#fff}.pt-bttn.-solid.-primary:active{background-color:#434190;border-color:#434190;color:#fff}.pt-bttn.-solid.-black{background-color:#1a202c;border-color:#1a202c;color:#fff}.pt-bttn.-solid.-black:hover,.pt-bttn.-solid.-black:focus{background-color:#2d3748;border-color:#2d3748;color:#fff}.pt-bttn.-solid.-black:active{background-color:#000;border-color:#000;color:#fff}.pt-bttn.-solid.-white{background-color:#fff;border-color:#fff;color:#1a202c}.pt-bttn.-solid.-white:hover,.pt-bttn.-solid.-white:focus{background-color:#f7fafc;border-color:#f7fafc}.pt-bttn.-solid.-white:active{background-color:#edf2f7;border-color:#edf2f7}.pt-bttn.-solid.-success{background-color:#2f855a;border-color:#2f855a;color:#fff}.pt-bttn.-solid.-success:hover,.pt-bttn.-solid.-success:focus{background-color:#38a169;border-color:#38a169}.pt-bttn.-solid.-success:active{background-color:#276749;border-color:#276749}.pt-bttn.-solid.-warning{background-color:#f6e05e;border-color:#f6e05e;color:#212121}.pt-bttn.-solid.-warning:hover,.pt-bttn.-solid.-warning:focus{background-color:#faf089;border-color:#faf089}.pt-bttn.-solid.-warning:active{background-color:#ecc94b;border-color:#ecc94b}.pt-bttn.-solid.-danger{background-color:#c53030;border-color:#c53030;color:#fff}.pt-bttn.-solid.-danger:hover,.pt-bttn.-solid.-danger:focus{background-color:#e53e3e;border-color:#e53e3e}.pt-bttn.-solid.-danger:active{background-color:#9b2c2c;border-color:#9b2c2c}.pt-bttn.-outline{padding:0 1rem}.pt-bttn.-outline.-primary{border-color:#4c51bf;color:#434190}.pt-bttn.-outline.-primary:active{color:#3c366b}.pt-bttn.-outline.-primary::before{background-color:#667eea}.pt-bttn.-outline.-black{border-color:#4a5568;color:#2d3748}.pt-bttn.-outline.-black:active{color:#1a202c}.pt-bttn.-outline.-black::before{background-color:#1a202c}.pt-bttn.-outline.-white{border-color:#fff;color:#fff}.pt-bttn.-outline.-white::before{background-color:#fff}.pt-bttn.-outline.-success{border-color:#2f855a;color:#276749}.pt-bttn.-outline.-success:active{color:#22543d}.pt-bttn.-outline.-success::before{background-color:#48bb78}.pt-bttn.-outline.-warning{border-color:#b7791f;color:#975a16}.pt-bttn.-outline.-warning:active{color:#744210}.pt-bttn.-outline.-warning::before{background-color:#ecc94b}.pt-bttn.-outline.-danger{border-color:#c53030;color:#9b2c2c}.pt-bttn.-outline.-danger:active{color:#742a2a}.pt-bttn.-outline.-danger::before{background-color:#f56565}.pt-bttn.-outline:hover::before,.pt-bttn.-outline:focus::before{opacity:0.1}.pt-bttn.-outline:active::before{opacity:0.15}.pt-bttn.-outline::before{content:"";display:inline-block;width:100%;height:100%;opacity:0;position:absolute;top:0;background-color:transparent;left:0;transition:all 75ms ease-in-out}.pt-bttn.-tall{height:52px;line-height:52px}.pt-bttn.-tall.-pill{border-radius:26px}.pt-bttn.-tall.-icon-only{width:52px}.pt-bttn.-wide{padding:0 2rem}.pt-bttn.-rounded{border-radius:0.25rem}.pt-bttn.-pill{border-radius:18px}.pt-bttn.-raised{box-shadow:0 4px 6px -1px rgba(0,0,0,0.1),0 2px 4px -1px rgba(0,0,0,0.06)}.pt-bttn.-raised.-solid.-white{border-color:#f7fafc}.pt-bttn.-raised.-solid.-white:active{border-color:#edf2f7}.pt-bttn.-raised:active{box-shadow:0 1px 2px 0 rgba(0,0,0,0.05);transform:translateY(2px)}.pt-bttn.-round{border-radius:50%}.pt-bttn.-round::before{border-radius:50%}.pt-bttn.-icon-only{padding:0;width:36px}.pt-bttn.-icon-only i{margin-right:0}.pt-bttn.-icon{padding:0 1rem 0 0.5rem}.pt-bttn i{display:inline-flex;justify-content:center;align-items:center;width:24px;height:24px;margin-right:0.25rem}.pt-bttn i svg{width:16px;height:16px}\n',""]),e.default=r},function(t,e,o){var n=o(1),r=o(7);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[t.i,r,""]]);var i={insert:"head",singleton:!1};n(r,i);t.exports=r.locals||{}},function(t,e,o){"use strict";o.r(e);var n=o(0),r=o.n(n)()(!1);r.push([t.i,'.page-builder{display:grid;grid-template-columns:320px 1fr;height:calc(100% - 64px);width:100%}.page-builder aside{background-color:#fff;border-right:1px solid #e2e8f0;padding:2rem;user-select:none}.page-builder .view{display:block;width:100%;overflow-y:scroll;padding:2rem;user-select:none}.page-builder .view .page{width:100%;max-width:1920px;background-color:#fff;border:1px solid #e2e8f0;position:relative;display:block;margin:0 auto;transition:all 150ms cubic-bezier(0.4, 0, 0.2, 1)}.page-builder .view .page.can-drop{border-color:#7f9cf5;box-shadow:0 0 0 4px #c3dafe}.page-builder .view .page .pt-instructions{display:block;width:100%;text-align:center;padding:4rem;color:#4a5568}.page-builder .view .page .drop-zone{display:block;width:100%;padding:2rem;pointer-events:none;user-select:none}.page-builder .view .page .drop-zone p{border:1px dashed #7f9cf5;color:#4c51bf;display:block;width:100%;padding:2rem;text-align:center}.capture-scroll{position:fixed;width:100%;height:2rem;left:0;background-color:transparent;z-index:99999;pointer-events:none}.capture-scroll.is-active{pointer-events:all}.capture-scroll.top{top:0}.capture-scroll.bottom{bottom:0}.pt-submitting{position:fixed;top:0;left:0;width:100vw;height:100vh;display:flex;justify-content:center;align-items:center;z-index:99999;text-align:center}.pt-submitting::before{content:"";opacity:0.75;background-color:#f7fafc;position:absolute;top:0;left:0;width:100%;height:100%}.pt-submitting div{transform:translateY(-4rem)}.pt-submitting div p{color:#1a202c;font-size:1.25rem;font-weight:500;margin-bottom:1.75rem;display:block}.pt-submitting div circle-rail-spinner{width:96px;height:96px;border-color:#f5f5f5;border-top-color:#4c51bf;border-width:5px}\n',""]),e.default=r},function(t,e,o){var n=o(1),r=o(9);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[t.i,r,""]]);var i={insert:"head",singleton:!1};n(r,i);t.exports=r.locals||{}},function(t,e,o){"use strict";o.r(e);var n=o(0),r=o.n(n)()(!1);r.push([t.i,"header{display:flex;align-items:center;justify-content:space-between;flex-flow:row nowrap;height:64px;padding:0 2rem;background-color:#fff;border-bottom:1px solid #e2e8f0;user-select:none}\n",""]),e.default=r},function(t,e,o){var n=o(1),r=o(11);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[t.i,r,""]]);var i={insert:"head",singleton:!1};n(r,i);t.exports=r.locals||{}},function(t,e,o){"use strict";o.r(e);var n=o(0),r=o.n(n)()(!1);r.push([t.i,"circle-rail-spinner{display:inline-block;height:64px;width:64px;box-sizing:border-box;border:4px solid #eee;border-top:4px solid #4c51bf;border-radius:50%;animation:circleRailSpinner 900ms infinite linear}circle-rail-spinner.-inline{display:inline-block;vertical-align:middle;margin:0}@keyframes circleRailSpinner{from{transform:rotate(0deg)}to{transform:rotate(359deg)}}\n",""]),e.default=r},function(t,e,o){var n=o(1),r=o(13);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[t.i,r,""]]);var i={insert:"head",singleton:!1};n(r,i);t.exports=r.locals||{}},function(t,e,o){"use strict";o.r(e);var n=o(0),r=o.n(n)()(!1);r.push([t.i,".title-input{display:inline-block;font-size:1.25rem;font-weight:500;color:#1a202c;transition:all 150ms cubic-bezier(0.4, 0, 0.2, 1);height:36px;line-height:36px;width:400px;text-overflow:ellipsis;padding:0 0.5rem;border-radius:0.25rem;border-style:solid;border-width:1px;border-color:transparent}.title-input:hover{border-color:#edf2f7}.title-input:focus{border-color:#7f9cf5;box-shadow:0 0 0 5px #ebf4ff;background-color:#fff}\n",""]),e.default=r},function(t,e,o){var n=o(1),r=o(15);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[t.i,r,""]]);var i={insert:"head",singleton:!1};n(r,i);t.exports=r.locals||{}},function(t,e,o){"use strict";o.r(e);var n=o(0),r=o.n(n)()(!1);r.push([t.i,".button-block{padding:0 0.5rem;border-radius:0.25rem;min-height:36px;display:flex;width:100%;flex-flow:row nowrap;align-items:center;cursor:move;transition:all 150ms cubic-bezier(0.4, 0, 0.2, 1);background-color:#fff;color:#4a5568;font-size:.875rem;margin-bottom:0.5rem;border:1px solid #edf2f7}.button-block:hover{box-shadow:0 1px 3px 0 rgba(0,0,0,0.1),0 1px 2px 0 rgba(0,0,0,0.06);color:#4c51bf;border-color:#7f9cf5}.button-block:active{box-shadow:none;background-color:#f7fafc;color:#1a202c}.button-block:focus-visible{border-color:#7f9cf5}.button-block.is-dragging{opacity:0.3;box-shadow:none}\n",""]),e.default=r},function(t,e,o){var n=o(1),r=o(17);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[t.i,r,""]]);var i={insert:"head",singleton:!1};n(r,i);t.exports=r.locals||{}},function(t,e,o){"use strict";o.r(e);var n=o(0),r=o.n(n)()(!1);r.push([t.i,'.pt-block{display:block;width:100%;position:relative;transition:all 150ms cubic-bezier(0.4, 0, 0.2, 1);user-select:none}.pt-block:hover,.pt-block:focus-within{z-index:999}.pt-block:hover:not(.dragging),.pt-block:focus-within:not(.dragging){box-shadow:0 0 0 2px #7f9cf5}.pt-block:hover .pt-block-menu,.pt-block:focus-within .pt-block-menu{opacity:1}.pt-block::after{content:"";position:absolute;left:0;width:100%;height:50%;background-color:#667eea;z-index:999;pointer-events:none;user-select:none;opacity:0;visibility:hidden;top:0;transform:translateY(50%)}.pt-block.dragging{opacity:0.3}.pt-block.dragging .pt-block-menu{opacity:1}.pt-block.dropzone.drop-top::after{transform:translateY(0%)}.pt-block.dropzone.drop-bottom::after{transform:translateY(100%)}.pt-block.dropzone::after{opacity:0.3;visibility:visible}.pt-block .pt-block-menu{z-index:9999;height:36px;border-radius:18px;background-color:#fff;box-shadow:0 4px 6px -1px rgba(0,0,0,0.1),0 2px 4px -1px rgba(0,0,0,0.06);position:absolute;top:1rem;right:1rem;border:1px solid #f7fafc;opacity:0;visibility:visible;transition:all 150ms cubic-bezier(0.4, 0, 0.2, 1);display:flex;align-items:center;flex-flow:row nowrap}.pt-block .pt-block-menu .pt-block-button{width:36px;height:36px;padding:0;display:inline-flex;justify-content:center;align-items:center;flex-flow:column wrap;color:#4a5568;transition:all 150ms cubic-bezier(0.4, 0, 0.2, 1)}.pt-block .pt-block-menu .pt-block-button.-danger::before{background-color:#f56565}.pt-block .pt-block-menu .pt-block-button.-danger svg{width:15px;height:15px}.pt-block .pt-block-menu .pt-block-button.-move{cursor:move}.pt-block .pt-block-menu .pt-block-button.-info svg{width:15px;height:15px}.pt-block .pt-block-menu .pt-block-button.-info:hover .pt-block-info{opacity:1;visibility:visible}.pt-block .pt-block-menu .pt-block-button.-info .pt-block-info{opacity:0;visibility:hidden;transition:all 150ms cubic-bezier(0.4, 0, 0.2, 1);position:absolute;top:calc(100% + 0.25rem);right:0;padding:0.5rem;border-radius:0.25rem;box-shadow:0 4px 6px -1px rgba(0,0,0,0.1),0 2px 4px -1px rgba(0,0,0,0.06);border:1px solid #f7fafc;color:#2d3748;background-color:#fff;font-size:.875rem;line-height:23px;width:225px}.pt-block .pt-block-menu .pt-block-button.-info .pt-block-info dt,.pt-block .pt-block-menu .pt-block-button.-info .pt-block-info dd{display:inline-block;text-align:left}.pt-block .pt-block-menu .pt-block-button.-info .pt-block-info dt{width:33%;font-weight:500}.pt-block .pt-block-menu .pt-block-button.-info .pt-block-info dd{width:66%;padding-left:0.5rem}.pt-block .pt-block-menu .pt-block-button:hover,.pt-block .pt-block-menu .pt-block-button:focus{color:#2d3748}.pt-block .pt-block-menu .pt-block-button:hover::before,.pt-block .pt-block-menu .pt-block-button:focus::before{opacity:0.07}.pt-block .pt-block-menu .pt-block-button:hover.-danger,.pt-block .pt-block-menu .pt-block-button:focus.-danger{color:#e53e3e}.pt-block .pt-block-menu .pt-block-button:active{color:#1a202c}.pt-block .pt-block-menu .pt-block-button:active::before{opacity:0.15}.pt-block .pt-block-menu .pt-block-button::before{content:"";background-color:#1a202c;width:calc(100% - 6px);height:calc(100% - 6px);border-radius:50%;position:absolute;opacity:0;transition:all 150ms cubic-bezier(0.4, 0, 0.2, 1)}.pt-block .pt-block-menu .pt-block-button svg{width:16px;height:16px}\n',""]),e.default=r},function(t,e,o){"use strict";o.r(e);var n,r,i,l,a,s={},c=[],d=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function p(t,e){for(var o in e)t[o]=e[o];return t}function u(t){var e=t.parentNode;e&&e.removeChild(t)}function h(t,e,o){var n,r=arguments,i={};for(n in e)"key"!==n&&"ref"!==n&&(i[n]=e[n]);if(arguments.length>3)for(o=[o],n=3;n<arguments.length;n++)o.push(r[n]);if(null!=o&&(i.children=o),"function"==typeof t&&null!=t.defaultProps)for(n in t.defaultProps)void 0===i[n]&&(i[n]=t.defaultProps[n]);return b(t,i,e&&e.key,e&&e.ref,null)}function b(t,e,o,r,i){var l={type:t,props:e,key:o,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:i};return null==i&&(l.__v=l),n.vnode&&n.vnode(l),l}function f(t){return t.children}function g(t,e){this.props=t,this.context=e}function v(t,e){if(null==e)return t.__?v(t.__,t.__.__k.indexOf(t)+1):null;for(var o;e<t.__k.length;e++)if(null!=(o=t.__k[e])&&null!=o.__e)return o.__e;return"function"==typeof t.type?v(t):null}function m(t){var e,o;if(null!=(t=t.__)&&null!=t.__c){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if(null!=(o=t.__k[e])&&null!=o.__e){t.__e=t.__c.base=o.__e;break}return m(t)}}function k(t){(!t.__d&&(t.__d=!0)&&r.push(t)&&!_.__r++||l!==n.debounceRendering)&&((l=n.debounceRendering)||i)(_)}function _(){for(var t;_.__r=r.length;)t=r.sort((function(t,e){return t.__v.__b-e.__v.__b})),r=[],t.some((function(t){var e,o,n,r,i,l,a;t.__d&&(l=(i=(e=t).__v).__e,(a=e.__P)&&(o=[],(n=p({},i)).__v=n,r=D(a,i,n,e.__n,void 0!==a.ownerSVGElement,null,o,null==l?v(i):l),M(o,i),r!=l&&m(i)))}))}function y(t,e,o,n,r,i,l,a,d,p){var h,g,m,k,_,y,w,S=n&&n.__k||c,B=S.length;for(d==s&&(d=null!=l?l[0]:B?v(n,0):null),o.__k=[],h=0;h<e.length;h++)if(null!=(k=o.__k[h]=null==(k=e[h])||"boolean"==typeof k?null:"string"==typeof k||"number"==typeof k?b(null,k,null,null,k):Array.isArray(k)?b(f,{children:k},null,null,null):null!=k.__e||null!=k.__c?b(k.type,k.props,k.key,null,k.__v):k)){if(k.__=o,k.__b=o.__b+1,null===(m=S[h])||m&&k.key==m.key&&k.type===m.type)S[h]=void 0;else for(g=0;g<B;g++){if((m=S[g])&&k.key==m.key&&k.type===m.type){S[g]=void 0;break}m=null}_=D(t,k,m=m||s,r,i,l,a,d,p),(g=k.ref)&&m.ref!=g&&(w||(w=[]),m.ref&&w.push(m.ref,null,k),w.push(g,k.__c||_,k)),null!=_?(null==y&&(y=_),d=x(t,k,m,S,l,_,d),p||"option"!=o.type?"function"==typeof o.type&&(o.__d=d):t.value=""):d&&m.__e==d&&d.parentNode!=t&&(d=v(m))}if(o.__e=y,null!=l&&"function"!=typeof o.type)for(h=l.length;h--;)null!=l[h]&&u(l[h]);for(h=B;h--;)null!=S[h]&&T(S[h],S[h]);if(w)for(h=0;h<w.length;h++)z(w[h],w[++h],w[++h])}function x(t,e,o,n,r,i,l){var a,s,c;if(void 0!==e.__d)a=e.__d,e.__d=void 0;else if(r==o||i!=l||null==i.parentNode)t:if(null==l||l.parentNode!==t)t.appendChild(i),a=null;else{for(s=l,c=0;(s=s.nextSibling)&&c<n.length;c+=2)if(s==i)break t;t.insertBefore(i,l),a=l}return void 0!==a?a:i.nextSibling}function w(t,e,o){"-"===e[0]?t.setProperty(e,o):t[e]="number"==typeof o&&!1===d.test(e)?o+"px":null==o?"":o}function S(t,e,o,n,r){var i,l,a,s,c;if(r?"className"===e&&(e="class"):"class"===e&&(e="className"),"style"===e)if(i=t.style,"string"==typeof o)i.cssText=o;else{if("string"==typeof n&&(i.cssText="",n=null),n)for(s in n)o&&s in o||w(i,s,"");if(o)for(c in o)n&&o[c]===n[c]||w(i,c,o[c])}else"o"===e[0]&&"n"===e[1]?(l=e!==(e=e.replace(/Capture$/,"")),a=e.toLowerCase(),e=(a in t?a:e).slice(2),o?(n||t.addEventListener(e,B,l),(t.l||(t.l={}))[e]=o):t.removeEventListener(e,B,l)):"list"!==e&&"tagName"!==e&&"form"!==e&&"type"!==e&&"size"!==e&&"download"!==e&&!r&&e in t?t[e]=null==o?"":o:"function"!=typeof o&&"dangerouslySetInnerHTML"!==e&&(e!==(e=e.replace(/^xlink:?/,""))?null==o||!1===o?t.removeAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase()):t.setAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase(),o):null==o||!1===o&&!/^ar/.test(e)?t.removeAttribute(e):t.setAttribute(e,o))}function B(t){this.l[t.type](n.event?n.event(t):t)}function C(t,e,o){var n,r;for(n=0;n<t.__k.length;n++)(r=t.__k[n])&&(r.__=t,r.__e&&("function"==typeof r.type&&r.__k.length>1&&C(r,e,o),e=x(o,r,r,t.__k,null,r.__e,e),"function"==typeof t.type&&(t.__d=e)))}function D(t,e,o,r,i,l,a,s,c){var d,u,h,b,v,m,k,_,x,w,S,B=e.type;if(void 0!==e.constructor)return null;(d=n.__b)&&d(e);try{t:if("function"==typeof B){if(_=e.props,x=(d=B.contextType)&&r[d.__c],w=d?x?x.props.value:d.__:r,o.__c?k=(u=e.__c=o.__c).__=u.__E:("prototype"in B&&B.prototype.render?e.__c=u=new B(_,w):(e.__c=u=new g(_,w),u.constructor=B,u.render=$),x&&x.sub(u),u.props=_,u.state||(u.state={}),u.context=w,u.__n=r,h=u.__d=!0,u.__h=[]),null==u.__s&&(u.__s=u.state),null!=B.getDerivedStateFromProps&&(u.__s==u.state&&(u.__s=p({},u.__s)),p(u.__s,B.getDerivedStateFromProps(_,u.__s))),b=u.props,v=u.state,h)null==B.getDerivedStateFromProps&&null!=u.componentWillMount&&u.componentWillMount(),null!=u.componentDidMount&&u.__h.push(u.componentDidMount);else{if(null==B.getDerivedStateFromProps&&_!==b&&null!=u.componentWillReceiveProps&&u.componentWillReceiveProps(_,w),!u.__e&&null!=u.shouldComponentUpdate&&!1===u.shouldComponentUpdate(_,u.__s,w)||e.__v===o.__v){u.props=_,u.state=u.__s,e.__v!==o.__v&&(u.__d=!1),u.__v=e,e.__e=o.__e,e.__k=o.__k,u.__h.length&&a.push(u),C(e,s,t);break t}null!=u.componentWillUpdate&&u.componentWillUpdate(_,u.__s,w),null!=u.componentDidUpdate&&u.__h.push((function(){u.componentDidUpdate(b,v,m)}))}u.context=w,u.props=_,u.state=u.__s,(d=n.__r)&&d(e),u.__d=!1,u.__v=e,u.__P=t,d=u.render(u.props,u.state,u.context),u.state=u.__s,null!=u.getChildContext&&(r=p(p({},r),u.getChildContext())),h||null==u.getSnapshotBeforeUpdate||(m=u.getSnapshotBeforeUpdate(b,v)),S=null!=d&&d.type==f&&null==d.key?d.props.children:d,y(t,Array.isArray(S)?S:[S],e,o,r,i,l,a,s,c),u.base=e.__e,u.__h.length&&a.push(u),k&&(u.__E=u.__=null),u.__e=!1}else null==l&&e.__v===o.__v?(e.__k=o.__k,e.__e=o.__e):e.__e=N(o.__e,e,o,r,i,l,a,c);(d=n.diffed)&&d(e)}catch(t){e.__v=null,n.__e(t,e,o)}return e.__e}function M(t,e){n.__c&&n.__c(e,t),t.some((function(e){try{t=e.__h,e.__h=[],t.some((function(t){t.call(e)}))}catch(t){n.__e(t,e.__v)}}))}function N(t,e,o,n,r,i,l,a){var d,p,u,h,b,f=o.props,g=e.props;if(r="svg"===e.type||r,null!=i)for(d=0;d<i.length;d++)if(null!=(p=i[d])&&((null===e.type?3===p.nodeType:p.localName===e.type)||t==p)){t=p,i[d]=null;break}if(null==t){if(null===e.type)return document.createTextNode(g);t=r?document.createElementNS("http://www.w3.org/2000/svg",e.type):document.createElement(e.type,g.is&&{is:g.is}),i=null,a=!1}if(null===e.type)f!==g&&t.data!==g&&(t.data=g);else{if(null!=i&&(i=c.slice.call(t.childNodes)),u=(f=o.props||s).dangerouslySetInnerHTML,h=g.dangerouslySetInnerHTML,!a){if(null!=i)for(f={},b=0;b<t.attributes.length;b++)f[t.attributes[b].name]=t.attributes[b].value;(h||u)&&(h&&u&&h.__html==u.__html||(t.innerHTML=h&&h.__html||""))}(function(t,e,o,n,r){var i;for(i in o)"children"===i||"key"===i||i in e||S(t,i,null,o[i],n);for(i in e)r&&"function"!=typeof e[i]||"children"===i||"key"===i||"value"===i||"checked"===i||o[i]===e[i]||S(t,i,e[i],o[i],n)})(t,g,f,r,a),h?e.__k=[]:(d=e.props.children,y(t,Array.isArray(d)?d:[d],e,o,n,"foreignObject"!==e.type&&r,i,l,s,a)),a||("value"in g&&void 0!==(d=g.value)&&d!==t.value&&S(t,"value",d,f.value,!1),"checked"in g&&void 0!==(d=g.checked)&&d!==t.checked&&S(t,"checked",d,f.checked,!1))}return t}function z(t,e,o){try{"function"==typeof t?t(e):t.current=e}catch(t){n.__e(t,o)}}function T(t,e,o){var r,i,l;if(n.unmount&&n.unmount(t),(r=t.ref)&&(r.current&&r.current!==t.__e||z(r,null,e)),o||"function"==typeof t.type||(o=null!=(i=t.__e)),t.__e=t.__d=void 0,null!=(r=t.__c)){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(t){n.__e(t,e)}r.base=r.__P=null}if(r=t.__k)for(l=0;l<r.length;l++)r[l]&&T(r[l],e,o);null!=i&&u(i)}function $(t,e,o){return this.constructor(t,o)}function j(t,e,o){var r,i,l;n.__&&n.__(t,e),i=(r=o===a)?null:o&&o.__k||e.__k,t=h(f,null,[t]),l=[],D(e,(r?e:o||e).__k=t,i||s,s,void 0!==e.ownerSVGElement,o&&!r?[o]:i?null:e.childNodes.length?c.slice.call(e.childNodes):null,l,o||s,r),M(l,t)}n={__e:function(t,e){for(var o,n;e=e.__;)if((o=e.__c)&&!o.__)try{if(o.constructor&&null!=o.constructor.getDerivedStateFromError&&(n=!0,o.setState(o.constructor.getDerivedStateFromError(t))),null!=o.componentDidCatch&&(n=!0,o.componentDidCatch(t)),n)return k(o.__E=o)}catch(e){t=e}throw t}},g.prototype.setState=function(t,e){var o;o=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=p({},this.state),"function"==typeof t&&(t=t(o,this.props)),t&&p(o,t),null!=t&&this.__v&&(e&&this.__h.push(e),k(this))},g.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),k(this))},g.prototype.render=f,r=[],i="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,_.__r=0,a=s;o(2),o(4),o(6),o(8),o(10),o(12);class L extends g{constructor(){super(...arguments),this.handleInput=t=>{const e=t.currentTarget;this.props.callback(e.value)},this.handleBlur=t=>{const e=t.currentTarget.value.trim();e.length?this.props.callback(e):this.props.callback("Untitled page")}}render(){return h("input",{autofocus:!0,className:"title-input",type:"text",autocapitalize:!1,autocomplete:"no",value:this.props.value,onInput:this.handleInput,onBlur:this.handleBlur})}}o(14);class E extends g{constructor(){super(),this.startDrag=t=>{t.dataTransfer.dropEffect="move",this.setState({dragging:!0}),this.props.callback(this.props.handle,this.props.id)},this.endDrag=()=>{this.setState({dragging:!1})},this.click=()=>{this.props.addBlockCallback(this.props.handle,null,null,this.props.id)},this.state={dragging:!1},this.button={current:null}}render(){return h("button",{className:"button-block "+(this.state.dragging?"is-dragging":""),onDragStart:this.startDrag,onDragEnd:this.endDrag,draggable:!0,onClick:this.click,ref:this.button},this.props.label)}}o(16);class P extends g{constructor(){super(),this.removeBlock=()=>{this.props.removeCallback(this.props.index)},this.startDrag=t=>{const e=document.body.querySelector("no-op")||document.createElement("no-op");e.style.cssText="opacity:0;visibility:hidden;position:absolute;top:-9999px;left:-9999px;",e.isConnected||document.body.appendChild(e),t.dataTransfer.setDragImage(e,0,0),this.setState({style:"dragging"}),this.props.startBlockShift(this.props.index)},this.dragOver=t=>{if(this.props.shiftingBlock!==this.props.index&&null!==this.props.shiftingBlock||this.props.newBlock){const e={x:t.clientX,y:t.clientY},o=this.block.current.getBoundingClientRect();let n=this.hitDetect(e,o);this.setState({style:"dropzone",dropPosition:-1===n?"top":"bottom"})}},this.dragLeave=t=>{this.props.shiftingBlock!==this.props.index&&this.setState({style:null,dropPosition:null})},this.handleDrop=t=>{if(t.preventDefault(),this.props.shiftingBlock!==this.props.index){const e={x:t.clientX,y:t.clientY},o=this.block.current.getBoundingClientRect();let n=this.hitDetect(e,o);(-1===n&&this.props.shiftingBlock===this.props.index-1||1===n&&this.props.shiftingBlock===this.props.index+1)&&(n=0),this.props.shiftBlocks(this.props.shiftingBlock,this.props.index,n)}this.setState({style:null})},this.endDrag=t=>{t.preventDefault(),this.setState({style:null})},this.handleMoveClick=t=>{t instanceof KeyboardEvent&&this.props.keyboardCallback(this.props.index===this.props.keyboardFocusedIndex?null:this.props.index)},this.cloneBlock=()=>{this.props.cloneBlockCallback(this.props.index)},this.state={style:null,dropPosition:null},this.block={current:null}}hitDetect(t,e){const o=e.y+e.height/2;return t.y>=o?1:-1}render(){return h("div",{ref:this.block,className:`pt-block ${this.props.keyboardFocusedIndex===this.props.index?"dragging":""} ${this.state.style} ${this.state.dropPosition?"drop-"+this.state.dropPosition:""}`,onDragOver:this.dragOver,onDrop:this.handleDrop,onDragLeave:this.dragLeave,"data-index":this.props.index},h("div",{className:"pt-block-menu"},h("button",{"aria-label":`move ${this.props.label} block's position`,onDragStart:this.startDrag,onDragEnd:this.endDrag,className:"pt-block-button -move",draggable:!0,onKeyPress:this.handleMoveClick},h("svg",{"aria-hidden":"true",focusable:"false",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},h("path",{fill:"currentColor",d:"M276 236.075h115.85v-76.15c0-10.691 12.926-16.045 20.485-8.485l96.149 96.149c4.686 4.686 4.686 12.284 0 16.971l-96.149 96.149c-7.56 7.56-20.485 2.206-20.485-8.485v-76.149H275.999v115.776h76.15c10.691 0 16.045 12.926 8.485 20.485l-96.149 96.15c-4.686 4.686-12.284 4.686-16.971 0l-96.149-96.149c-7.56-7.56-2.206-20.485 8.485-20.485H236V276.075H120.149v76.149c0 10.691-12.926 16.045-20.485 8.485L3.515 264.56c-4.686-4.686-4.686-12.284 0-16.971l96.149-96.149c7.56-7.56 20.485-2.206 20.485 8.485v76.15H236V120.15h-76.149c-10.691 0-16.045-12.926-8.485-20.485l96.149-96.149c4.686-4.686 12.284-4.686 16.971 0l96.149 96.149c7.56 7.56 2.206 20.485-8.485 20.485H276v115.925z"}))),h("button",{"aria-label":`clone ${this.props.label} block`,onClick:this.cloneBlock,className:"pt-block-button"},h("svg",{"aria-hidden":"true",focusable:"false",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},h("g",{class:"fa-group"},h("path",{class:"fa-secondary",fill:"currentColor",d:"M48 512a48 48 0 0 1-48-48V176a48 48 0 0 1 48-48h48v208a80.09 80.09 0 0 0 80 80h208v48a48 48 0 0 1-48 48H48z",opacity:"0.4"}),h("path",{class:"fa-primary",fill:"currentColor",d:"M512 48v288a48 48 0 0 1-48 48H176a48 48 0 0 1-48-48V48a48 48 0 0 1 48-48h288a48 48 0 0 1 48 48z"})))),h("button",{"aria-label":this.props.label+" block info",className:"pt-block-button -info"},h("svg",{"aria-hidden":"true",focusable:"false",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 192 512"},h("path",{fill:"currentColor",d:"M20 424.229h20V279.771H20c-11.046 0-20-8.954-20-20V212c0-11.046 8.954-20 20-20h112c11.046 0 20 8.954 20 20v212.229h20c11.046 0 20 8.954 20 20V492c0 11.046-8.954 20-20 20H20c-11.046 0-20-8.954-20-20v-47.771c0-11.046 8.954-20 20-20zM96 0C56.235 0 24 32.235 24 72s32.235 72 72 72 72-32.235 72-72S135.764 0 96 0z"})),h("dl",{className:"pt-block-info"},h("dt",null,"Block:"),h("dd",null,this.props.label),h("dt",null,"Group:"),h("dd",null,this.props.group))),h("button",{"aria-label":`delete ${this.props.label} block`,onClick:this.removeBlock,className:"pt-block-button -danger"},h("svg",{"aria-hidden":"true",focusable:"false",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"},h("path",{fill:"currentColor",d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"})))),h("div",{className:"pt-block-shell",style:{width:"100%",position:"relative",display:"block"},dangerouslySetInnerHTML:{__html:this.props.html}}))}}const H=document.body.querySelector("#page-builder-mounting-point");j(h(class extends g{constructor(){super(),this.dragOver=t=>{t.preventDefault();const e={...this.state};e.drag.over=!0,this.setState(e)},this.dragLeave=t=>{t.preventDefault();const e={...this.state};e.drag.over=!1,this.setState(e)},this.handleDrop=t=>{t.preventDefault(),this.state.drag.handle&&!this.state.view.length&&this.loadBlock(this.state.drag.handle,null,null,this.state.drag.id)},this.handleReset=()=>{window.confirm("Are you sure you want to trash this page layout?")&&this.setState({view:[]})},this.startBodyDrag=t=>{let e=t.clientY<=100?-1:1;const o={...this.state};o.drag.scrollDirection=e,this.setState(o)},this.endBodyDrag=t=>{const e={...this.state};e.drag.scrollDirection=0,this.setState(e)},this.handleKeyboardMove=t=>{if(t instanceof KeyboardEvent&&null!==this.state.keyboardFocusedIndex){switch(t.key.toLowerCase()){case"arrowup":this.keyboardShiftBlock(-1);break;case"arrowdown":this.keyboardShiftBlock(1)}}},this.createPage=async()=>{if(!this.state.view.length)return;this.setState({submitting:!0});const t=new FormData;t.append("CRAFT_CSRF_TOKEN",H.dataset.csrf),t.append("sectionId","1"),t.append("enabled","0"),t.append("title",this.state.title);for(let e=0;e<this.state.view.length;e++)t.append("fields[pageBuilder][sortOrder][]","new"+(e+1)),t.append(`fields[pageBuilder][blocks][new${e+1}][type]`,(()=>this.state.view[e].split("-").map((t,e)=>e?t.charAt(0).toUpperCase()+t.slice(1).toLowerCase():t).join(""))());const e=await fetch(location.origin+"/actions/entries/save-entry",{method:"POST",credentials:"include",headers:new Headers({Accept:"application/json"}),body:t}),o=await e.json();e.ok?(null==o?void 0:o.success)?location.href=`${location.origin}/${H.dataset.cpTrigger}/entries/pages/${o.id}`:this.setState({submitting:!1}):this.setState({submitting:!0})},this.handleURLPrompt=()=>{let t=`${location.origin}/${H.dataset.cpTrigger}/papertrain/page-builder`;for(let e=0;e<this.state.view.length;e++)switch(e){case 0:t+="?b="+this.state.view[e];break;default:t+="&b="+this.state.view[e]}prompt("Share this page layout.",t)},this.renderBlockButton=(t,e)=>{if(t.group===e)return h(E,{label:t.label,handle:t.handle,callback:this.setDragHandle.bind(this),addBlockCallback:this.loadBlock.bind(this),id:t.id})},this.renderGroup=t=>{let e=this.state.blocks.map(e=>this.renderBlockButton(e,t.handle));return h("div",{className:"block w-full mb-4"},h("h3",{className:"block w-full mb-1 font-grey-800 font-medium cursor-default text-uppercase"},t.label),e)},this.renderBlock=(t,e)=>{let o=this.state.blockData[t].html,n=null;for(let e=0;e<this.state.blocks.length;e++)if(this.state.blocks[e].handle===t){n=this.state.blocks[e];break}let r=null;for(let t=0;t<this.state.groups.length;t++)if(this.state.groups[t].handle===n.group){r=this.state.groups[t];break}return h(P,{index:e,html:o,removeCallback:this.removeBlock.bind(this),shiftBlocks:this.shiftBlocks.bind(this),shiftingBlock:this.state.drag.index,startBlockShift:this.startBlockShift.bind(this),keyboardCallback:this.keyboardShift.bind(this),keyboardFocusedIndex:this.state.keyboardFocusedIndex,label:n.label,group:r.label,newBlock:this.state.drag.handle,cloneBlockCallback:this.cloneBlock.bind(this),handle:n.handle})},this.view={current:null},this.state={ready:!1,title:"Untitled page",groups:[],blocks:[],blockData:{},view:[],drag:{over:!1,handle:null,index:null,scrollDirection:0,id:null},keyboardFocusedIndex:null,submitting:!1}}async fetchBlocks(){const t=await fetch(`${location.origin}/${H.dataset.cpTrigger}/papertrain/api/config.json`,{method:"GET",credentials:"include",headers:new Headers({Accept:"application/json"})}),e=await t.json();if(t.ok){const t={...this.state};t.groups=e.groups,t.blocks=e.blocks,this.setState(t)}}async fetchBlock(t,e){if(!document.head.querySelector(`link[href="${location.origin}/assets/${t}.css"]`)){const e=document.createElement("link");e.href=`${location.origin}/assets/${t}.css`,e.rel="stylesheet",document.head.appendChild(e)}if(!document.head.querySelector(`script[src="${location.origin}/assets/${t}.mjs"]`)){const e=document.createElement("script");e.src=`${location.origin}/assets/${t}.mjs`,e.type="module",document.head.appendChild(e)}const o=await fetch(`${location.origin}/${H.dataset.cpTrigger}/papertrain/api/render/block/${e}/${t}`,{method:"GET",credentials:"include"});return await o.text()}async loadBlockResources(t){let e;for(let o=0;o<this.state.blocks.length;o++)if(this.state.blocks[o].handle===t){e=this.state.blocks[o];break}for(let t=0;t<e.resources.length;t++){let o,n=e.resources[t].match(/(\.css)$/)?"link":"script";o=e.resources[t].match(/^(http)|^(https)/)?e.resources[t]:`${location.origin}/assets/${e.resources[t]}`;const r=document.createElement(n);"link"===n?document.head.querySelector(`link[href="${o}"]`)||(r.href=o,r.rel="stylesheet",console.log("asd")):document.head.querySelector(`script[src="${o}"]`)||(r.src=o,r.type=o.match(/(\.mjs)/)?"module":"text/javascript"),document.head.appendChild(r)}}async fetchBlockData(t){const e=await fetch(`${location.origin}/${H.dataset.cpTrigger}/papertrain/api/block/${t}.json`,{method:"GET",credentials:"include",headers:new Headers({Accept:"application/json"})});return(await e.json()).data}async loadBlock(t,e=null,o=null,n=null){var r;if((null===(r=this.state.blockData)||void 0===r?void 0:r[t])||null===n){const n={...this.state};null!==e&&null!==o?-1===o?n.view.splice(e,0,t):n.view.splice(e+1,0,t):n.view.push(t),this.setState(n)}else{this.loadBlockResources(t);const r=await this.fetchBlock(t,n),i=await this.fetchBlockData(n),l={...this.state};l.blockData[t]={html:r,data:i},null!==e&&null!==o?-1===o?l.view.splice(e,0,t):l.view.splice(e+1,0,t):l.view.push(t),this.setState(l)}setTimeout(()=>{null===e&&null===o&&this.view.current.scrollTo({top:this.view.current.scrollHeight,left:0,behavior:"smooth"}),this.setState({drag:{over:!1,handle:null,index:null,scrollDirection:0,id:null}})},150)}startBlockShift(t){this.setState({drag:{handle:null,over:!0,index:t,scrollDirection:0,id:null}})}updateTitle(t){this.setState({title:t})}removeBlock(t){const e={...this.state};e.view.splice(t,1),this.setState(e);const o=document.body.querySelector("button");o.focus(),o.blur()}shiftBlocks(t,e,o){if(null===t&&null!==this.state.drag.handle&&null!==this.state.drag.id)return void this.loadBlock(this.state.drag.handle,e,o,this.state.drag.id);if(e>=this.state.view.length||e<0)return;if(0!==o){const n={...this.state},r=n.view[t];n.view.splice(t,1),-1===o?n.view.splice(e,0,r):n.view.splice(e+1,0,r),this.setState(n)}const n=document.body.querySelector("button");n.focus(),n.blur(),setTimeout(()=>{this.setState({drag:{over:!1,handle:null,index:null,scrollDirection:0,id:null}})},150)}keyboardShift(t){this.setState({keyboardFocusedIndex:t})}scrollCallback(){this.view.current.scrollBy({top:10*this.state.drag.scrollDirection,left:0,behavior:"auto"}),window.requestAnimationFrame(()=>{this.scrollCallback()})}keyboardShiftBlock(t){const e=this.state.keyboardFocusedIndex+t;if(e<0||e>=this.state.view.length)return;const o={...this.state},n=o.view[this.state.keyboardFocusedIndex];o.view.splice(this.state.keyboardFocusedIndex,1),o.view.splice(e,0,n),o.keyboardFocusedIndex=e,this.setState(o)}setDragHandle(t,e){const o={...this.state};o.drag.handle=t,o.drag.id=e,this.setState(o)}cloneBlock(t){const e={...this.state},o=e.view[t];e.view.splice(t,0,o),this.setState(e),setTimeout(()=>{this.setState({drag:{over:!1,handle:null,index:null,scrollDirection:0,id:null}})},150)}setInitialState(){let t=new URLSearchParams(location.search).getAll("b"),e=0;new Promise(o=>{0===t.length&&o();for(let n=0;n<t.length;n++)this.loadBlock(t[n]).then(()=>{e++,t.length===e&&o()})}).then(()=>{window.history.replaceState(null,null,`${location.origin}/${H.dataset.cpTrigger}/papertrain/page-builder`),this.setState({view:t,ready:!0}),setTimeout(()=>{this.view.current.scrollTo({top:0,left:0,behavior:"auto"}),this.setState({drag:{over:!1,handle:null,index:null,scrollDirection:0,id:null}})},150)})}componentDidUpdate(){document.body.querySelectorAll("img").forEach(t=>{t.draggable=!1})}componentDidMount(){this.fetchBlocks();const t=document.createElement("link");t.href=location.origin+"/assets/normalize.css",t.rel="stylesheet",document.head.appendChild(t);const e=document.createElement("link");e.href=location.origin+"/assets/brixi.css",e.rel="stylesheet",document.head.appendChild(e);const o=document.createElement("link");o.href=location.origin+"/assets/buttons.css",o.rel="stylesheet",document.head.appendChild(o),document.addEventListener("keyup",this.handleKeyboardMove),this.scrollCallback(),this.setInitialState()}render(){let t=null;t=this.state.blocks.length?this.state.groups.map(t=>this.renderGroup(t)):h("div",{style:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"}},h("circle-rail-spinner",{role:"alert","aria-busy":"true","aria-live":"polite"}),";");let e=null;e=this.state.view.length&&this.state.ready?this.state.view.map((t,e)=>this.renderBlock(t,e)):this.state.ready?this.state.drag.over?h("div",{className:"drop-zone"},h("p",null,"Release the block to add it to the page.")):h("p",{className:"pt-instructions"},"Click and drag the block on the left to begin building a new page."):h("div",{style:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"}},h("circle-rail-spinner",{role:"alert","aria-busy":"true","aria-live":"polite"}),";");let o=null;return this.state.submitting&&(o=h("div",{className:"pt-submitting"},h("div",null,h("p",null,"Creating page..."),h("circle-rail-spinner",{role:"alert","aria-busy":"true","aria-live":"polite"}),";"))),h(f,null,h("header",{style:{filter:this.state.submitting?"blur(4px)":""}},h(L,{value:this.state.title,callback:this.updateTitle.bind(this)}),h("div",null,h("button",{onClick:this.handleURLPrompt,className:"pt-bttn -text -grey -icon-only -round"},h("i",null,h("svg",{"aria-hidden":"true",focusable:"false",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},h("path",{fill:"currentColor",d:"M503.691 189.836L327.687 37.851C312.281 24.546 288 35.347 288 56.015v80.053C127.371 137.907 0 170.1 0 322.326c0 61.441 39.581 122.309 83.333 154.132 13.653 9.931 33.111-2.533 28.077-18.631C66.066 312.814 132.917 274.316 288 272.085V360c0 20.7 24.3 31.453 39.687 18.164l176.004-152c11.071-9.562 11.086-26.753 0-36.328z"})))),h("button",{onClick:this.handleReset,className:"pt-bttn -danger -text -icon-only -round",style:{marginLeft:"0.25rem"}},h("i",null,h("svg",{"aria-hidden":"true",focusable:"false",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"},h("path",{fill:"currentColor",d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"})))),h("button",{onClick:this.createPage,className:"pt-bttn -text -primary -icon-only -round",style:{marginLeft:"0.25rem"}},h("i",null,h("svg",{"aria-hidden":"true",focusable:"false",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"},h("path",{fill:"currentColor",d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"})))))),h("main",{style:{filter:this.state.submitting?"blur(4px)":""},className:"page-builder"},h("aside",null,t),h("div",{className:"view",ref:this.view},h("div",{className:"page "+(this.state.drag.over?"can-drop":""),onDragOver:this.dragOver,onDragLeave:this.dragLeave,onDrop:this.handleDrop},e,null))),h("div",{onDragEnter:this.startBodyDrag,onDragLeave:this.endBodyDrag,className:"capture-scroll top "+(null!==this.state.drag.handle||null!==this.state.drag.index?"is-active":"")}),h("div",{onDragEnter:this.startBodyDrag,onDragLeave:this.endBodyDrag,className:"capture-scroll bottom "+(null!==this.state.drag.handle||null!==this.state.drag.index?"is-active":"")}),o)}},null),H)}]);